<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard de Horas e Tempo</title>
<style>
  body {
    font-family: "Poppins", sans-serif;
    background: linear-gradient(135deg, #2c3e50, #4ca1af);
    color: #fff;
    text-align: center;
    padding: 40px;
  }
  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 25px;
  }
  .card {
    background: rgba(255,255,255,0.1);
    border-radius: 18px;
    padding: 25px;
    backdrop-filter: blur(8px);
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    transition: transform 0.2s;
  }
  .card:hover {
    transform: translateY(-6px);
  }
  .city {
    font-size: 1.6rem;
    font-weight: 600;
    margin-bottom: 10px;
  }
  .time {
    font-size: 2.4rem;
    font-weight: 700;
    margin: 15px 0;
  }
  .temp {
    font-size: 1.8rem;
    font-weight: 500;
  }
  .forecast {
    font-size: 1.1rem;
    margin-top: 10px;
    opacity: 0.85;
  }
</style>
</head>
<body>
  <div class="grid" id="dashboard"></div>

<script>
const cities = [
  { name: "Lisboa ğŸ‡µğŸ‡¹", lat: 38.7169, lon: -9.1399, timezone: "Europe/Lisbon" },
  { name: "Riyadh ğŸ‡¸ğŸ‡¦", lat: 24.7136, lon: 46.6753, timezone: "Asia/Riyadh" },
  { name: "Luanda ğŸ‡¦ğŸ‡´", lat: -8.8383, lon: 13.2344, timezone: "Africa/Luanda" },
  { name: "Detroit ğŸ‡ºğŸ‡¸", lat: 42.3314, lon: -83.0458, timezone: "America/Detroit" },
  { name: "Kaiseraugst ğŸ‡¨ğŸ‡­", lat: 47.5397, lon: 7.7314, timezone: "Europe/Zurich" },
  { name: "Homburg ğŸ‡«ğŸ‡·", lat: 49.3167, lon: 7.3333, timezone: "Europe/Paris" },
  { name: "Utrecht ğŸ‡³ğŸ‡±", lat: 52.0907, lon: 5.1214, timezone: "Europe/Amsterdam" },
  { name: "Morrisville ğŸ‡ºğŸ‡¸", lat: 35.8235, lon: -78.8256, timezone: "America/New_York" }
];

// ====== API METEO ======
async function fetchWeather(city) {
  const url = `https://api.open-meteo.com/v1/forecast?latitude=${city.lat}&longitude=${city.lon}&current=temperature_2m,weathercode&hourly=temperature_2m,weathercode&timezone=${city.timezone}`;
  const res = await fetch(url);
  return res.json();
}

function getWeatherIcon(code) {
  const icons = {
    0: "â˜€ï¸", 1: "ğŸŒ¤ï¸", 2: "â›…", 3: "â˜ï¸",
    45: "ğŸŒ«ï¸", 48: "ğŸŒ«ï¸",
    51: "ğŸŒ¦ï¸", 61: "ğŸŒ§ï¸", 71: "ğŸŒ¨ï¸",
    80: "ğŸŒ¦ï¸", 95: "â›ˆï¸"
  };
  return icons[code] || "â“";
}

// ====== CRIA O DASHBOARD COMPLETO (hora + tempo) ======
async function updateDashboard() {
  const dashboard = document.getElementById("dashboard");
  dashboard.innerHTML = "";

  for (const city of cities) {
    const weather = await fetchWeather(city);

    const now = new Date().toLocaleTimeString("pt-PT", {
      timeZone: city.timezone,
      hour: "2-digit",
      minute: "2-digit"
    });

    const currentTemp = weather.current?.temperature_2m ?? "--";
    const currentCode = weather.current?.weathercode ?? 0;
    const nextHourTemp = weather.hourly?.temperature_2m?.[1] ?? "--";
    const nextHourCode = weather.hourly?.weathercode?.[1] ?? 0;

    const div = document.createElement("div");
    div.className = "card";

    div.innerHTML = `
      <div class="city">${city.name}</div>
      <div class="time" data-timezone="${city.timezone}">${now}</div>
      <div class="temp">${getWeatherIcon(currentCode)} ${currentTemp}Â°C</div>
      <div class="forecast">PrÃ³xima hora: ${getWeatherIcon(nextHourCode)} ${nextHourTemp}Â°C</div>
    `;

    dashboard.appendChild(div);
  }
}

// ====== ATUALIZA APENAS AS HORAS (MINUTO A MINUTO) ======
function updateTimesOnly() {
  document.querySelectorAll(".time").forEach(el => {
    const timezone = el.getAttribute("data-timezone");
    el.textContent = new Date().toLocaleTimeString("pt-PT", {
      timeZone: timezone,
      hour: "2-digit",
      minute: "2-digit"
    });
  });
}

// Atualiza tudo agora
updateDashboard();

// Atualiza tempo e previsÃµes de hora a hora
setInterval(updateDashboard, 3600000);

// Atualiza sÃ³ as horas a cada minuto
setInterval(updateTimesOnly, 60000);
</script>
</body>
</html>
